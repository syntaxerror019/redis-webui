<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Redis Dashboard</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body { background-color: #f4f6f8; min-height: 100vh; display:flex; flex-direction:column; }
    main { flex: 1; padding: 2rem; }
    .card { border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,0.08); margin-bottom:1.5rem; }
    .progress { height: 22px; }
    .small-muted { font-size:.85rem; color:#6c757d; }
    footer { background:#fff; border-top:1px solid #e9ecef; padding:0.75rem 1rem; }
    .badge-custom { font-weight:500; }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand bg-white border-bottom">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="#">
        <i class="bi bi-kanban-fill me-2" style="font-size:1.25rem;color:#0d6efd;"></i>
        <span class="fw-bold">Redis WebUI</span>
        <span class="badge bg-light text-dark ms-2 small">v1.1</span>
      </a>
      <div class="d-flex align-items-center">
        <a class="btn btn-outline-secondary btn-sm me-2" href="https://github.com/syntaxerror019/redis-webui" target="_blank" rel="noopener">
          <i class="bi bi-github"></i> Source
        </a>
      </div>
    </div>
  </nav>

  <main class="container">
    <h2 class="mb-4 text-center">Redis Dashboard</h2>

    <!-- Memory Usage -->
    <div class="card p-3">
      <h5 class="card-title">Memory Usage</h5>
      <p>Used Memory: <b>{{ info.used_memory_human }}</b> / Total Memory: <b>{{ info.total_system_memory_human }}</b></p>
      <div class="progress">
        <div class="progress-bar bg-success" role="progressbar"
          style="width: {{ (info.used_memory / info.total_system_memory * 100)|round(2) }}%"
          aria-valuenow="{{ (info.used_memory / info.total_system_memory * 100)|round(2) }}" aria-valuemin="0" aria-valuemax="100">
          {{ (info.used_memory / info.total_system_memory * 100)|round(2) }}%
        </div>
      </div>
    </div>

    <!-- Uptime & Clients -->
    <div class="row">
      <div class="col-md-6">
        <div class="card text-center p-3">
          <h5 class="card-title">Uptime</h5>
          <p class="card-text">{{ info.uptime_in_days }} days ({{ info.uptime_in_seconds }} s)</p>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card text-center p-3">
          <h5 class="card-title">Connected Clients</h5>
          <p class="card-text">{{ info.connected_clients }}</p>
        </div>
      </div>
    </div>

    <!-- CPU & Commands -->
    <div class="row">
      <div class="col-md-6">
        <div class="card text-center p-3">
          <h5 class="card-title">CPU Usage</h5>
          <p class="card-text">System: {{ info.used_cpu_sys }} | User: {{ info.used_cpu_user }}</p>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card text-center p-3">
          <h5 class="card-title">Commands Processed</h5>
          <p class="card-text">{{ info.total_commands_processed }}</p>
        </div>
      </div>
    </div>

    <!-- Database Info -->
    <div class="card p-3">
      <h5 class="card-title">Database Info</h5>
      <table class="table table-striped mb-0">
        <thead>
          <tr>
            <th>DB</th>
            <th>Keys</th>
            <th>Expires</th>
            <th>Avg TTL</th>
          </tr>
        </thead>
        <tbody>
          {% for db, stats in info.items() if db.startswith('db') %}
          <tr>
            <td>{{ db }}</td>
            <td>{{ stats.keys }}</td>
            <td>{{ stats.expires }}</td>
            <td>{{ stats.avg_ttl }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Keys List -->
    <div class="card p-3">
      <h5 class="card-title">Redis Keys</h5>
      <ul class="list-group">
        {% for key, value in keys.items() %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          {{ key }}
          <span class="badge bg-primary rounded-pill badge-custom">{{ value }}</span>
        </li>
        {% endfor %}
      </ul>

      <!-- Pagination -->
      <nav aria-label="Keys pagination">
        <ul class="pagination justify-content-center mt-3">
          {% if page > 1 %}
          <li class="page-item">
            <a class="page-link" href="/?page={{ page-1 }}">Previous</a>
          </li>
          {% else %}
          <li class="page-item disabled"><span class="page-link">Previous</span></li>
          {% endif %}

          {% for p in range(1, total_pages + 1) %}
          <li class="page-item {% if p == page %}active{% endif %}">
            <a class="page-link" href="/?page={{ p }}">{{ p }}</a>
          </li>
          {% endfor %}

          {% if page < total_pages %}
          <li class="page-item">
            <a class="page-link" href="/?page={{ page+1 }}">Next</a>
          </li>
          {% else %}
          <li class="page-item disabled"><span class="page-link">Next</span></li>
          {% endif %}
        </ul>
      </nav>

      <div class="mt-3 text-center">
        <a href="/logout" class="btn btn-secondary">
          <i class="bi bi-arrow-left-circle"></i> Connect to Another Redis
        </a>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="text-center">
    <div class="container d-flex justify-content-between align-items-center">
      <div class="small-muted">
        &copy; <span id="year"></span> Redis WebUI â€” made with <i class="bi bi-heart-fill text-danger"></i> by <a href="https://www.mileshilliard.com" target="_blank" rel="noopener">Miles Hilliard</a>
      </div>
      <div>
        <a href="https://github.com/syntaxerror019/redis-webui" target="_blank" rel="noopener" class="small-muted text-decoration-none">
          <i class="bi bi-github"></i> View on GitHub
        </a>
      </div>
    </div>
  </footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
